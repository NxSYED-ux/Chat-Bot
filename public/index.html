<!DOCTYPE html>
<body>
<h2>Open-Ended Chatbot (Mistral/Mixtral)</h2>
<div id="chat"></div>
<div id="bar">
    <input id="msg" placeholder="Ask anything..." />
    <button id="send">Send</button>
</div>


<script>
    const chat = document.getElementById('chat');
    const input = document.getElementById('msg');
    const sendBtn = document.getElementById('send');
    const history = [];


    function append(role, text) {
        const div = document.createElement('div');
        div.className = 'row ' + (role === 'user' ? 'me' : 'bot');
        div.textContent = (role === 'user' ? 'You: ' : 'Bot: ') + text;
        chat.appendChild(div);
        chat.scrollTop = chat.scrollHeight;
    }


    async function send() {
        const message = input.value.trim();
        if (!message) return;
        append('user', message);
        input.value = '';


        const res = await fetch('/chat', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ message, history })
        });
        const data = await res.json();
        const reply = data.reply || data.error || '(no reply)';
        append('assistant', reply);

        history.push({ role: 'user', content: message });
        history.push({ role: 'assistant', content: reply });
    }


    sendBtn.onclick = send;
    input.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') send();
    });
</script>
</body>
</html>